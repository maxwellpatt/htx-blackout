"0","# geodatabase file path"
"0","gdp_path <- 'data/ACS_2019_5YR_TRACT_48_TEXAS.gdb'"
"0",""
"0","# load the geometries from the ACS data"
"0","acs_geom_raw <- st_read(here::here(gdp_path), layer = ""ACS_2019_5YR_TRACT_48_TEXAS"", quiet = TRUE)"
"0",""
"0","# transform CRS to EPSG:3083"
"0","acs_geom <- st_transform(acs_geom_raw, crs = 3083)"
"0",""
"0","# load the ACS income data"
"0","acs_income <- st_read(here::here(gdp_path), layer = ""X19_INCOME"", quiet = TRUE)"
"0",""
"0","# select the median income column"
"0","acs_income_selected <- acs_income[, c(""GEOID"", ""B19013e1"")]"
"0",""
"0","# trim the GEOID in acs_income_selected to keep the last 11 characters"
"0","acs_income_selected$GEOID <- substr(acs_income_selected$GEOID, nchar(acs_income_selected$GEOID) - 10, nchar(acs_income_selected$GEOID))"
"0",""
"0","# ensure that GEOID columns are of the same data type"
"0","# convert GEOID to character if they are not"
"0","acs_income_selected$GEOID <- as.character(acs_income_selected$GEOID)"
"0","acs_geom$GEOID <- as.character(acs_geom$GEOID)"
"0",""
"0","# join the datasets"
"0","acs_data <- merge(acs_geom, acs_income_selected, by = ""GEOID"")"
"0",""
"0","# merge census tract information to each impacted building"
"0","impacted_homes_with_tract <- st_join(impacted_homes, acs_data, join = st_intersects)"
"0",""
"0","# aggregate to find unique census tracts that have had blackouts"
"0","tracts_with_blackouts <- unique(impacted_homes_with_tract$GEOID)"
"0",""
"0","# create a subset of acs_data with only tracts that experienced blackouts"
"0","acs_data_blackouts <- acs_data[acs_data$GEOID %in% tracts_with_blackouts, ]"
